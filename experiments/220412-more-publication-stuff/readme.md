# 220412 More publication stuff


Some more notebooks for finishing up the initial publication.


## Notebooks


### 220412-recreate-old-fig3-1

Recreation of old plot created as initial example version of figure 3 in the paper, which only uses
a single example genome from Set 3. Originally from `200811-fastq-kmer-counts-basic-comparison`,
adapted to newest GAMBIT version.

Uses same file as in original, `16AC1611139-CAP_S14_L001_R1_001`.

#### Results

Some of the numbers are very slightly different from the original for some reason, but close enough.
Plots look identical.


### 220412-recreate-old-fig3-2

Same as previous, but using file `17AC0012455-1A_S1_L001_R1_001` which had poor performance in
latest draft of figure 3 analysis.

#### Results

Poor precision and recall.


### 220412-recreate-old-fig3-3

Same as previous, but using file `19AC0011209PEA_S8_L001_R1_001` which had poor performance in
latest draft of figure 3 analysis.

#### Results

Very similar to `17AC0012455-1A_S1_L001_R1_001`.


### 220412-set2-taxonomy

Gets NCBI taxonomy tree for genomes in set 2. Find KPCOFGS lineage for each.


### 220419-set3-files-list

We're apparently still working on finalizing the list of genomes for set 3, which should include at
least some of the additional set of 18 I had not been including up until this point. This notebook
just tries to get a full accounting of the original unmodified files, including checksums, so I know
exactly what I'm starting with.


### 220420-pt-table-results-comparison

Takes "MIDAS PT Table" (curated subset of set3 genomes from David, containing query results from a
long time ago) and compares to GAMBIT query results using newest software and database.

Results look equivalent.


### 220501-db-overlaps-summary-draft

Draft notebook, saving because I used to generate a table sent to David.


### 220507-db-pw-dists

Analyzes pairwise distances between database genomes (minimum and maximum aggregated by leaf taxon)
generated by in-development `gambit-publication` rule `db_taxa_pw_dist_ranges`. Calculates diameters
for all database taxa and finds remaining overlaps (min_inter less than diameter).

#### Results

Double-checked no overlaps relative to thresholds.

Number of taxa with overlaps (min_inter < diameter):

| Rank    | Num taxa | Has overlap |
|---------|----------|-------------|
| genus   | 452      | 117         |
| species | 1415     | 44          |
| none    | 50       | 10          |

Also attempted to determine how thresholds were derived for all taxa:

| Method           | Count |
|------------------|-------|
| By hand          | 31    |
| Diameter         | 1661  |
| 95% of min_inter | 205   |
| No threshold     | 20    |



## Comments

### Figure 3 files

Best parameter values for each file:

| File                | Min PHRED | Min Count | Precision | Recall | Jaccard | Rank | Percentile |
|---------------------+-----------+-----------+-----------+--------+---------+------+------------|
| 16AC1611139-CAP_S14 |        12 |         2 |     0.995 |  0.997 |   0.006 |   13 |       0.15 |
| 17AC0012455-1A_S1   |        11 |         4 |     0.964 |  0.876 |   0.150 |   77 |       0.98 |
| 19AC0011209PEA_S8   |        17 |         3 |     0.903 |  0.891 |   0.185 |   78 |       1.00 |



## Files

### Source

* `./data-src/`
  * `220420-midas-pt-table.csv` - Copy of [MIDAS PT Table](https://docs.google.com/spreadsheets/d/1_QE0e66NdklxcsedMgCNnqv7lIYfrcFnFbFmDxYXRVQ/)
    ("Internal use only" sheet) on Google Drive.
  * `220420-set3-query-1.0-beta2.csv` - query results for set 3 genomes using latest GAMBIT software/database version.
  * `220430-leaf-min-dists.csv` - Minimum pairwise distances between leaf taxa in database, produced
    by in-development rule `db_taxa_pw_dist_ranges`.
  * `220430-leaf-max-dists.csv` - Maximum pairwise distances between leaf taxa in database, produced
    by in-development rule `db_taxa_pw_dist_ranges`.


### Output

* `data/processed/220412-more-publication-stuff/`
  * `220412-set2-taxonomy/`
    * `220412-set2-lineages.csv` - KPCOFGS names for all genomes.
	* `220412-set-taxa.csv` - Table of taxa in other table.
  * `220419-set3-files-list/`
    * `220419-200726-gold-standard-files.csv` - Original FASTA and FASTQ file names and MD5 sums for
      all 98 genomes originally part of this set.
  * `220420-pt-table-results-comparison/`
    * `220420-pt-table-results-comp.csv` - "Midas PT Table" joined to newest GAMBIT results.
  * `220507-db-pw-dists/`
    * `220507-db-dists-summary.csv` - Table with diameter and min_inter of all taxa in GAMBIT database.
    * `220507-db-overlaps.csv` - Table of all overlaps remaining in database (min_inter less than
      diameter, each row is an in/out taxon pair).
